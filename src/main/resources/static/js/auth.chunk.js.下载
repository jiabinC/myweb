webpackJsonp([1],{1038:function(e,t){e.exports={wrap:"SmartCaptcha__wrap",invalid:"SmartCaptcha__invalid"}},1039:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return n[e]||e};var n={nc_login:"nc_login",login_h5:"login_h5",nc_register:"register",register_h5:"register_h5",nc_message:"message",message_h5:"nc_message_h5"}},1042:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(1043),E=n(_),b=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={minValue:e.minValue||0,maxValue:e.maxValue||100,value:e.value||0,nextValue:e.nextValue||0},a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({minValue:e.minValue||0,maxValue:e.maxValue||100,value:e.value||0,nextValue:e.nextValue||0})}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.progressClassName,n=e.label,l=e.unit,u=void 0===l?"":l,r=e.showInlineValue,i=e.showOuterValue,s=this.state,o=s.value,d=void 0===o?0:o,c=s.nextValue,f=void 0===c?0:c,m=s.minValue,p=void 0===m?0:m,h=s.maxValue,g=void 0===h?100:h,_=(d-p)/(g-p),b=_<=1&&(100*_).toFixed(3)+"%",y=(f-p)/(g-p),w=f<=g&&(100*y).toFixed(3)+"%",k=v.default.createElement("div",{role:"progressbar",className:"\n        "+a+"\n        "+((this.isNextValueOverflow||_>1)&&E.default.overflow)+"\n        "+E.default.main+" "+(!i&&t)+"\n      "},v.default.createElement("div",{style:{width:w||"100%"},className:E.default.nextvalue}),v.default.createElement("div",{style:{width:b||"100%"},"aria-valuenow":100*_,className:E.default.value+" "+(d===p?E.default.zero:"")},r?v.default.createElement("span",{className:E.default.valuetext},b):null));return i?v.default.createElement("table",{className:t+" "+E.default.table},v.default.createElement("tbody",null,v.default.createElement("tr",null,n&&v.default.createElement("td",{className:E.default.label},n),v.default.createElement("td",{className:E.default.progress},k),v.default.createElement("td",{className:E.default.outervalue},(f||d).toFixed(0)+u+"/"+(g.toFixed(0)+u))))):k}},{key:"setValue",value:function(e){if("number"!=typeof e)throw new Error("should set number value");return this.setState((0,u.default)({},this.state,{value:e})),this}},{key:"setNextValue",value:function(e){if("number"!=typeof e)throw new Error("should set number nextValue");return this.setState((0,u.default)({},this.state,{nextValue:e})),this}},{key:"isNextValueOverflow",get:function(){var e=this.state,t=e.nextValue,a=void 0===t?0:t,n=e.maxValue;return a>(void 0===n?100:n)}}]),t}(v.default.Component);t.default=b,b.propTypes={label:h.default.string,className:h.default.string,progressClassName:h.default.string,maxValue:h.default.number,minValue:h.default.number,value:h.default.number,nextValue:h.default.number,unit:h.default.string,showInlineValue:h.default.bool,showOuterValue:h.default.bool}},1043:function(e,t){e.exports={main:"Progress__main",overflow:"Progress__overflow",nextvalue:"Progress__nextvalue",value:"Progress__value",valuetext:"Progress__valuetext",zero:"Progress__zero",table:"Progress__table",label:"Progress__label",progress:"Progress__progress",outervalue:"Progress__outervalue"}},1254:function(e,t){e.exports={main:"Links__main",currentlang:"Links__currentlang",lang:"Links__lang"}},1255:function(e,t){e.exports={main:"migration__main",tips:"migration__tips",form:"migration__form",whatsnew:"migration__whatsnew",action:"migration__action",space:"migration__space",arrow:"migration__arrow",shakeY:"migration__shakeY",page:"migration__page",showpage:"migration__showpage",progresswrap:"migration__progresswrap",progresstext:"migration__progresstext",upgradetipmodal:"migration__upgradetipmodal",upgradetip:"migration__upgradetip"}},856:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(58),E=a(15),b=a(885),y=n(b),w=a(331),k=n(w),N=a(325),x=n(N),S=a(889),C=n(S),P=a(67),O=n(P),T=a(335),L=n(T),A=a(50),j=n(A),M=a(895),V=n(M),I=a(8),R=a(103),q=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onLogin=a.onLogin.bind(a),a.onOAuthSuccess=a.onOAuthSuccess.bind(a),a.onOAuthFailure=a.onOAuthFailure.bind(a),a.onChangeAutoLogin=a.onChangeAutoLogin.bind(a),a.onChangeUsername=a.onChangeUsername.bind(a),a.isChange=!1,a.state={tips:null,logging:null,current_username:localStorage.getItem("current_username")||void 0},a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"componentWillMount",value:function(){var e=this.props.auth.user,t=void 0===e?{}:e,a=this.context.toUrl;t.username&&a({type:"replace"}),window.isImpressWebView&&localStorage.setItem("auto_login","true")}},{key:"onOAuthSuccess",value:function(e,t){var a=this.context,n=a.logIn;(0,a.closeURL)(),n(t)}},{key:"onOAuthFailure",value:function(e,t){var a=t.code,n=t.data;100403===a&&E.browserHistory.push({pathname:"/register",state:(0,u.default)({},e.data,n)})}},{key:"onLogin",value:function(e){var t=this,a=this.props.dispatch,n=this.state.logging,l=this.context.logIn,r=this.refs,i=r.username,s=r.password,o=r.captcha,d=i.value,c=s.value;if(e.preventDefault(),(0,I.validForm)(i,s,o)&&n!==d){this.setState((0,u.default)({},this.state,{logging:d,tips:null}));var f=!1;a((0,R.login)((0,u.default)({},o.value,{username:d,password:c}))).then(function(e){l(e),f=!0}).catch(function(e){if(o.reset(),f)throw new Error(e);t.setState((0,u.default)({},t.state,{logging:null,tips:{state:"FAILURE",title:"",content:e.message}}))})}}},{key:"onChangeAutoLogin",value:function(e){e?localStorage.setItem("auto_login","true"):localStorage.removeItem("auto_login")}},{key:"onChangeUsername",value:function(e){e&&(this.isChange=!0);var t=this.state.current_username,a=this.refs,n=a.username,l=a.password;t&&(t!==e&&t.startsWith(e)&&(l.setValue(),n.setValue()),localStorage.removeItem("current_username"),this.setState((0,u.default)({},this.state,{current_username:void 0})))}},{key:"render",value:function(){var e=this.props,t=e.i18n,a=e.location,n=this.state,l=n.logging,r=n.tips,i=n.current_username,s="true"===localStorage.getItem("auto_login");return v.default.createElement("main",{className:y.default.main},v.default.createElement("div",{className:y.default.space}),v.default.createElement("form",{className:y.default.form,onSubmit:this.onLogin},v.default.createElement("div",{className:y.default.tipswrap},v.default.createElement(k.default,{tips:r,role:"alert"})),v.default.createElement(O.default,{ref:"username",onChange:this.onChangeUsername,placeholder:t[907],defaultValue:i,autoFocus:!i,className:y.default.input,type:"text",icon:"#svg_sprite_user",autoComplete:"username",autoCapitalize:"none",name:"username",required:!0,requiredText:t[906]}),v.default.createElement(O.default,{ref:"password",placeholder:t[908],autoFocus:!!i,className:y.default.input,type:"password",icon:"#svg_sprite_password",autoComplete:"off",name:"password",required:!0,requiredText:t[900]}),v.default.createElement(V.default,{ref:"captcha",i18n:t,className:y.default.input,scene:"login"}),v.default.createElement("div",{className:y.default.input},v.default.createElement(x.default,{name:"autoLogin",checked:s,autoComplete:"off",onChange:this.onChangeAutoLogin},t[1102]),v.default.createElement(E.Link,{className:"clickable "+y.default.inlinelink,to:(0,u.default)({},a,{pathname:"/forgotpass"})},t[1004])),v.default.createElement("button",{className:"alone reverse "+y.default.button+" "+(l&&"nohover"),onClick:this.onLogin,type:"submit"},l?v.default.createElement(j.default,{className:y.default.loading}):t[1101]),v.default.createElement(L.default,{title:t[1104],action:"login",onOAuthFailure:this.onOAuthFailure,onOAuthSuccess:this.onOAuthSuccess}),v.default.createElement("p",{className:y.default.relatedlink},t[1103]," ",v.default.createElement(E.Link,{className:"clickable",to:(0,u.default)({},a,{pathname:"/register"})},t[119]))),v.default.createElement("div",{className:y.default.links},v.default.createElement(C.default,{i18n:t})))}}]),t}(v.default.Component);q.propTypes={auth:h.default.object,i18n:h.default.object,location:h.default.object,dispatch:h.default.func},q.contextTypes={logIn:h.default.func,closeURL:h.default.func,toUrl:h.default.func};var F=function(e){return{auth:e.auth,i18n:e.i18n}};t.default=(0,_.connect)(F)(q)},857:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(58),E=a(885),b=n(E),y=a(331),w=n(y),k=a(67),N=n(k),x=a(889),S=n(x),C=a(26),P=n(C),O=a(103),T=a(8),L=a(876),A=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onForgotpass=a.onForgotpass.bind(a),a.changeGuid=a.changeGuid.bind(a),a.email="",a.state={isRecovered:!1,guid:(0,T.guid)(),tips:null},a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"onForgotpass",value:function(){var e=this;this.setState((0,u.default)({},this.state,{tips:null}));var t=this.props.dispatch,a=this.refs,n=a.email,l=a.code,r=this.state.guid;(0,T.validForm)(n,l)&&(this.email=n.value,t((0,O.forgotpass)({email:n.value,code:l.value,guid:r})).then(function(){return e.setState((0,u.default)({},e.state,{isRecovered:!0}))}).catch(this.changeGuid))}},{key:"render",value:function(){var e=void 0,t=this.props.i18n,a=this.state,n=a.isRecovered,l=a.guid,u=a.tips;switch((this.email.match(/@.*/)||[])[0]){case"@qq.com":e="https://mail.qq.com/";break;case"@163.com":e="http://mail.163.com/";break;case"@sina.com":case"@sina.cn":e="http://mail.sina.com/";break;case"@gmail.com":e="http://mail.gmail.com/";break;case"@live.com":case"@outlook.com":e="http://mail.live.com/";break;default:e=""}var r=v.default.createElement("img",{onClick:this.changeGuid,style:{verticalAlign:"-.9em",height:"2.8em"},src:"//"+P.default.api.host+"/captcha?guid="+l,alt:"vert image"}),i=v.default.createElement("div",{className:b.default.form},v.default.createElement("p",{className:b.default.recoveredtitle},v.default.createElement("i",{className:"icon_success"})),v.default.createElement("p",{className:b.default.recoveredtext},v.default.createElement("span",null,t[1e3]),v.default.createElement("br",null),v.default.createElement("span",null,e?v.default.createElement("a",{href:e,target:"_blank"},t[1001]):t[1002])));return v.default.createElement("main",{className:b.default.main},v.default.createElement("div",{className:b.default.space}),n?i:v.default.createElement("form",{className:b.default.form},v.default.createElement("div",{className:b.default.tipswrap},v.default.createElement(w.default,{tips:u,role:"alert"})),v.default.createElement("fieldset",null,v.default.createElement("legend",null,t[123]),v.default.createElement(N.default,{ref:"email",className:b.default.input,type:"email",required:!0,errorText:t[903],pattern:L.emailPattern},t[904],":"),v.default.createElement(N.default,{ref:"code",className:b.default.input,labeled:r,required:!0,pattern:L.imageVerifyPattern},t[905],":")),v.default.createElement("button",{type:"button",onClick:this.onForgotpass,className:"alone "+b.default.aligninput+" "+b.default.input},t[1003])),v.default.createElement("div",{className:b.default.links},v.default.createElement(S.default,{i18n:t})))}},{key:"changeGuid",value:function(e){this.setState((0,u.default)({},this.state,{guid:(0,T.guid)(),tips:e.message&&{state:"FAILURE",title:"",content:e.message}}))}}]),t}(v.default.Component);A.propTypes={i18n:h.default.object,location:h.default.object,dispatch:h.default.func};var j=function(e){return{i18n:e.i18n}};t.default=(0,_.connect)(j)(A)},858:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(2),u=n(l),r=a(3),i=n(r),s=a(4),o=n(s),d=a(5),c=n(d),f=a(6),m=n(f),p=a(1),h=n(p),g=a(58),v=a(15),_=a(885),E=n(_),b=a(331),y=n(b),w=a(67),k=n(w),N=a(889),x=n(N),S=a(103),C=a(8),P=a(876),O=function(e){function t(e){(0,u.default)(this,t);var a=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSubmit=function(e){return e.preventDefault()},a.onResetpass=a.onResetpass.bind(a),a.state={tips:null},a}return(0,c.default)(t,e),(0,i.default)(t,[{key:"onResetpass",value:function(){var e=this;this.setState({tips:null});var t=this.props,a=t.dispatch,n=t.location,l=this.refs,u=l.password,r=l.repassword;(0,C.validForm)(u,r)&&a((0,S.resetpass)({password:u.value,confirm:r.value,token:n.query.token})).then(function(){v.browserHistory.push("/login")}).catch(function(t){e.setState({tips:{state:"FAILURE",title:"",content:t.message}})})}},{key:"render",value:function(){var e=this.props.i18n,t=this.state.tips;return h.default.createElement("main",{className:E.default.main},h.default.createElement("div",{className:E.default.space}),h.default.createElement("form",{className:E.default.form,onSubmit:this.onSubmit},h.default.createElement("div",{className:E.default.tipswrap},h.default.createElement(y.default,{tips:t,role:"alert"})),h.default.createElement("fieldset",null,h.default.createElement("legend",null,e[124]),h.default.createElement("input",{type:"password",style:{display:"none"}}),h.default.createElement(k.default,{ref:"password",className:E.default.input,type:"password",required:!0,requiredText:e[900],pattern:P.passwordPattern,errorText:e[911]},e[1401],":"),h.default.createElement(k.default,{ref:"repassword",className:E.default.input,type:"password",required:!0,requiredText:e[912],pattern:P.passwordPattern,errorText:e[911]},e[1402],":")),h.default.createElement("button",{type:"button",onClick:this.onResetpass,className:"alone "+E.default.aligninput+" "+E.default.input},e[1403])),h.default.createElement("div",{className:E.default.links},h.default.createElement(x.default,{i18n:e})))}}]),t}(h.default.Component);O.propTypes={i18n:m.default.object,location:m.default.object,dispatch:m.default.func};var T=function(e){return{i18n:e.i18n}};t.default=(0,g.connect)(T)(O)},859:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(15),E=a(885),b=n(E),y=a(8),w=a(889),k=n(w),N=a(50),x=n(N),S=a(103),C=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.updateTime=a.updateTime.bind(a),a.goHome=a.goHome.bind(a),a.state={result:null,time:6},a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.context,a=t.dispatch,n=t.location.query;a((0,S.verifyemail)(n)).then(function(){e.setState((0,u.default)({},e.state,{result:1}))}).catch(function(){e.setState((0,u.default)({},e.state,{result:2}))}).always(function(){return setTimeout(e.updateTime.bind(e),0)})}},{key:"componentWillUnmount",value:function(){window.clearTimeout(this.updateTime.timer)}},{key:"render",value:function(){var e=this.state,t=e.result,a=e.time,n=this.context.i18n;return v.default.createElement("main",{className:b.default.main},v.default.createElement("div",{className:b.default.space}),v.default.createElement("div",{className:b.default.middlewrap+" "+b.default.form},v.default.createElement("i",{className:b.default.space}),!t&&v.default.createElement(x.default,{className:b.default.middle},n[1505]),t&&v.default.createElement("p",{className:b.default.middle,role:1===t?"tooltip":"alert"},1===t?n[1501]:n[1502],(0,y.i18nEmbed)(n[1503],a),v.default.createElement("span",{className:"clickable underline",onClick:this.goHome},n[1504]))),v.default.createElement("div",{className:b.default.links},v.default.createElement(k.default,{i18n:n})))}},{key:"goHome",value:function(){_.browserHistory.replace("/home")}},{key:"updateTime",value:function(){var e=this.state.time;e>1?(this.setState((0,u.default)({},this.state,{time:e-1})),this.updateTime.timer=setTimeout(this.updateTime.bind(this),1e3)):this.goHome()}}]),t}(v.default.Component);t.default=C,C.contextTypes={i18n:h.default.object,location:h.default.object,dispatch:h.default.func}},860:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(58),E=a(15),b=a(885),y=n(b),w=a(331),k=n(w),N=a(67),x=n(N),S=a(889),C=n(S),P=a(335),O=n(P),T=a(50),L=n(T),A=a(895),j=n(A),M=a(26),V=n(M),I=a(103),R=a(8),q=a(876),F=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onRegister=a.onRegister.bind(a),a.onOAuthSuccess=a.onOAuthSuccess.bind(a),a.onOAuthFailure=a.onOAuthFailure.bind(a),a.state={registering:null,tips:null,oAuthData:null},a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.state,t=e||{},a=t.platform,n=t.authId,l=t.access_token;a&&n&&l&&this.setState((0,u.default)({},this.state,{oAuthData:e}))}},{key:"onOAuthSuccess",value:function(e,t){var a=this.context,n=a.logIn;(0,a.closeURL)(),n(t)}},{key:"onOAuthFailure",value:function(e,t){var a=t.code,n=t.data;100403===a&&this.setState((0,u.default)({},this.state,{oAuthData:(0,u.default)({},e.data,n)}))}},{key:"onRegister",value:function(e){var t=this,a=this.refs,n=a.username,l=a.email,r=a.password,i=a.repassword,s=a.captcha,o=this.props.dispatch,d=this.context.logIn,c=this.state,f=c.registering,m=c.oAuthData;if(ga("send","event","Button","click","regBtn"),e.preventDefault(),(0,R.validForm)(n,l,r,i,s)&&!f){this.setState((0,u.default)({},this.state,{registering:!0,tips:null}));var p={username:n.value,email:l.value,password:r.value,confirm:i.value};o(m?(0,I.oauth)((0,u.default)({},p,m),"register"):(0,I.register)((0,u.default)({},s.value,p))).then(d).catch(function(e){s&&s.reset(),t.setState((0,u.default)({},t.state,{registering:null,tips:{state:"FAILURE",title:"",content:e.message}}))})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.i18n,n=t.location,l=this.state,r=l.registering,i=l.tips,s=l.oAuthData,o=s&&(s.userInfo&&s.userInfo.username||a[1309]),d=o&&new RegExp(q.usernamePattern).test(o);return v.default.createElement("main",{className:y.default.main},v.default.createElement("div",{className:y.default.space}),v.default.createElement("form",{className:y.default.form,onSubmit:this.onRegister},v.default.createElement("div",{className:y.default.tipswrap},v.default.createElement(k.default,{tips:i,role:"alert"})),s&&v.default.createElement("div",null,v.default.createElement("h1",{className:y.default.oauthregtitle},(0,R.i18nEmbed)(a[1306],s.platform.toUpperCase(),o)),v.default.createElement("p",{className:y.default.oauthregdec},a[1307],v.default.createElement("br",null),a[1308])),v.default.createElement("input",{type:"password",style:{display:"none"}}),v.default.createElement(x.default,{ref:"username",icon:"#svg_sprite_user",placeholder:a[907],defaultValue:d?o:void 0,name:"username",autoCapitalize:"none",autoComplete:"off",className:y.default.input,type:"text",required:!0,requiredText:a[909],pattern:q.usernamePattern,errorText:a[1301],hintText:!0,labeled:v.default.createElement("span",null,".",V.default.user_host)}),v.default.createElement(x.default,{ref:"email",placeholder:a[904],name:"email",icon:"#svg_sprite_email",autoComplete:"off",className:y.default.input,type:"email",required:!0,requiredText:a[910],pattern:q.emailPattern,errorText:a[903]}),v.default.createElement(x.default,{ref:"password",placeholder:a[908],name:"password",icon:"#svg_sprite_password",autoComplete:"off",className:y.default.input,type:"password",required:!0,requiredText:a[900],pattern:q.passwordPattern,errorText:a[911],hintText:!0}),v.default.createElement(x.default,{ref:"repassword",placeholder:a[1302],name:"confirm",icon:"#svg_sprite_password",autoComplete:"off",className:y.default.input,type:"password",required:!0,requiredText:a[912],pattern:q.passwordPattern,errorText:a[911],hintText:!0,getDepend:function(){return e.refs.password}}),!s&&v.default.createElement(j.default,{ref:"captcha",i18n:a,className:y.default.input,scene:"register"}),v.default.createElement("div",{className:y.default.terms},(0,R.i18nEmbed)(a[1310],v.default.createElement("a",{key:"1",target:"_blank",className:"clickable",href:"http://www.yupoo.com/info/terms/"},a[1311]))),v.default.createElement("button",{onClick:this.onRegister,className:"alone reverse "+y.default.button+" "+(r&&"nohover"),type:"submit"},r?v.default.createElement(L.default,{className:y.default.loading}):a[1303]),!s&&v.default.createElement(O.default,{title:a[1305],action:"register",onOAuthFailure:this.onOAuthFailure,onOAuthSuccess:this.onOAuthSuccess}),!s&&v.default.createElement("p",{className:y.default.relatedlink},a[1304]," ",v.default.createElement(E.Link,{className:"clickable",to:(0,u.default)({},n,{pathname:"/login"})},a[118]))),v.default.createElement("div",{className:y.default.links},v.default.createElement(C.default,{i18n:a})))}}]),t}(v.default.Component);F.propTypes={i18n:h.default.object,location:h.default.object,dispatch:h.default.func},F.contextTypes={logIn:h.default.func,closeURL:h.default.func};var U=function(e){return{i18n:e.i18n}};t.default=(0,_.connect)(U)(F)},861:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(58),E=a(15),b=a(885),y=n(b),w=a(1255),k=n(w),N=a(67),x=n(N),S=a(1042),C=n(S),P=a(85),O=n(P),T=a(335),L=n(T),A=a(103),j=a(142),M=a(22),V=a(8),I=a(26),R=n(I),q=a(141),F=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onMigrate=a.onMigrate.bind(a),a.getState=a.getState.bind(a),a.onWheel=a.onWheel.bind(a),a.onPageWheel=a.onPageWheel.bind(a),a.fromClientHeight=null,a.state={showPage:!1,fromStyle:{},event:null},a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e,t=this,a=this.props,n=a.dispatch,l=a.location.query.utm_source,r=this.refs.from.clientHeight;j.fetchActiveEvent.result=j.fetchActiveEvent.result||n((0,j.fetchActiveEvent)()),j.fetchActiveEvent.result.then(function(e){return t.setState((0,u.default)({},t.state,{event:e}))}),r>200&&(this.fromClientHeight=this.refs.from.clientHeight+"px",this.setState((0,u.default)({},this.state,{fromStyle:{height:this.fromClientHeight}}))),V.messageTaskPool.add(this.onPageWheel),V.resizeTaskPool.add(function(){return t.fromClientHeight="auto"}),"old_version"===l&&setTimeout((e=this.refs.upgradetip).open.bind(e))}},{key:"componentWillUnmount",value:function(){V.messageTaskPool.delete(this.onPageWheel)}},{key:"onPageWheel",value:function(e){"scrollToTop"===e.type&&this.onWheel({deltaY:-1})}},{key:"onWheel",value:function(e){var t=e.deltaY,a=this.state.showPage,n=this.refs,l=n.iframe;n.upgradetip.isOpen||!a==t>0&&(this.setState({fromStyle:a?{height:this.fromClientHeight}:{opacity:0,height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},showPage:!a}),a&&l.contentWindow.postMessage({type:"nocanscroll"},"*"))}},{key:"onMigrate",value:function(e){var t=this,a=this.props.dispatch,n=this.refs,l=n.username,u=n.password;if(e.preventDefault(),(0,V.validForm)(l,u)){var r={username:l.value,password:u.value};a({type:M.SHOW_CONFIRM,payload:{completeBtnText:"确认升级",complete:function(){return a((0,A.migrate)(r)).then(function(){return t.getState(r)})},content:"提醒：升级后无法退回到老版，敬请谅解。"}})}}},{key:"getState",value:function(e){var t=this.props.dispatch,a=this.context.logIn,n=this.refs,l=n.progressModal,u=n.progress,r=0;l.open().freeze();var i=setInterval(function(){return t((0,A.migratestate)(e.token?e:{username:e.username})).then(function(n){if(!n.code)return clearInterval(i),l.close(),void(e.token?setTimeout(function(){t({type:M.SHOW_ALERT,payload:{title:"迁移成功！",duration:0}})},300):t((0,A.login)(e)).then(a));if(-1===n.code)throw new Error;if(3!==n.code){var s=10*r++;u.setValue(s>=100?99:s)}}).catch(function(){clearInterval(i),l.clear().close()})},500)}},{key:"render",value:function(){var e=this,t=this.props.i18n,a=this.state,n=a.fromStyle,l=a.showPage,u=a.event,r=u&&u.find(function(e){var t=e.target;return t&&t.includes("x_console")&&t.includes("migration")});return v.default.createElement("main",{className:y.default.main+" "+k.default.main+" "+(l&&k.default.showpage),onWheel:this.onWheel},v.default.createElement("ol",{className:k.default.tips},v.default.createElement("li",null,"1. 输入用户名和密码验证身份"),v.default.createElement("li",null,"2. 二次确认"),v.default.createElement("li",null,"3. 升级中"),v.default.createElement("li",null,"4. 完成升级，进入新版")),v.default.createElement("form",{ref:"from",style:n,className:y.default.form+" "+k.default.form,onSubmit:this.onMigrate},v.default.createElement("fieldset",null,v.default.createElement("legend",null,"开始升级图片管家",r&&v.default.createElement("a",{title:r.title,className:"button reverse",href:"//"+R.default.website_host+"/event/"+r.id+function(){return E.browserHistory.createPath({pathname:"",query:{utm_source:"x_console",utm_medium:"migration",utm_campaign:r.name}})}(),target:"_blank"},"升级活动介绍")),v.default.createElement(x.default,{ref:"username",className:y.default.input,type:"text",icon:"username",autoComplete:"username",autoCapitalize:"none",name:"username",required:!0,requiredText:t[906]},t[907],":"),v.default.createElement(x.default,{ref:"password",className:y.default.input,type:"password",icon:"password",autoComplete:"password",name:"password",required:!0,requiredText:t[900]},t[908],":")),v.default.createElement("button",{type:"button",onClick:this.onMigrate,className:"alone"},t[1201]),v.default.createElement("span",{className:"alone "+k.default.action},v.default.createElement("i",{className:"clickable onlydesktop",onClick:this.onWheel.bind(null,{deltaY:1})},"新版介绍"),v.default.createElement("a",{className:"alone clickable",target:"_blank",href:"//"+R.default.website_host+"/help/quickstart/1"},"新手引导")),v.default.createElement(L.default,{title:t[3038],action:"migration",onOAuthSuccess:this.getState})),v.default.createElement("div",{className:k.default.space}),v.default.createElement("div",{className:"onlydesktop "+k.default.arrow},v.default.createElement("svg",{onClick:this.onWheel.bind(null,{deltaY:l?-1:1}),width:"36.417px",height:"26.167px",viewBox:"0 0 36.417 26.167"},v.default.createElement("path",{d:"M34.965,7.437c-0.307,0-0.615,0.114-0.85,0.342L18.27,23.133L2.299,7.776 c-0.478-0.46-1.245-0.451-1.712,0.019C0.12,8.267,0.128,9.021,0.607,9.481l16.82,16.173c0.471,0.454,1.225,0.453,1.695-0.003 l16.69-16.174c0.477-0.461,0.482-1.216,0.014-1.685C35.59,7.556,35.277,7.437,34.965,7.437L34.965,7.437L34.965,7.437z M5.746,0.173 c-0.209,0-0.419,0.08-0.578,0.239C4.856,0.726,4.863,1.229,5.182,1.536l12.527,12.046c0.314,0.302,0.815,0.302,1.129,0L31.287,1.583 c0.318-0.308,0.324-0.81,0.012-1.124c-0.311-0.314-0.822-0.319-1.141-0.012L18.272,11.902L6.31,0.399 C6.153,0.248,5.949,0.173,5.746,0.173L5.746,0.173L5.746,0.173z"}))),v.default.createElement("iframe",{ref:"iframe",className:k.default.page,src:"//"+R.default.website_host+"/event/20170517?lang="+(0,q.getApplyLanguage)()+"&iframe=true"}),v.default.createElement(O.default,{ref:"progressModal"},v.default.createElement("div",{className:k.default.progresswrap},v.default.createElement(C.default,{ref:"progress",showInlineValue:!0}),v.default.createElement("p",{className:k.default.progresstext},"相册升级中，请不要关闭该窗口"))),v.default.createElement("div",{className:k.default.upgradetipmodal},v.default.createElement(O.default,{ref:"upgradetip",fullscreen:!1,title:"发现新版本",className:k.default.upgradetip},v.default.createElement("ol",null,v.default.createElement("li",null,"♦ 界面全面优化"),v.default.createElement("li",null,"♦ 完美适配手机"),v.default.createElement("li",null,"♦ 全新加入视频功能"),v.default.createElement("li",null,"♦ 海外访问提速3倍")),v.default.createElement("p",null,"图片管家已全新升级，续费入口已迁至新版"),v.default.createElement("button",{className:"reverse",onClick:function(){return e.refs.upgradetip.close()}},"知道了"))))}}]),t}(v.default.Component);F.propTypes={i18n:h.default.object,location:h.default.object,dispatch:h.default.func},F.contextTypes={logIn:h.default.func};var U=function(e){return{i18n:e.i18n}};t.default=(0,_.connect)(U)(F)},862:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(2),u=n(l),r=a(3),i=n(r),s=a(4),o=n(s),d=a(5),c=n(d),f=a(6),m=n(f),p=a(1),h=n(p),g=a(885),v=n(g),_=a(8),E=a(359),b=n(E),y=a(889),w=n(y),k=a(103),N=function(e){function t(e){(0,u.default)(this,t);var a=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onAuth=a.onAuth.bind(a),a.state={name:"",site:""},a}return(0,c.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.context,a=t.dispatch,n=t.user,l=t.location,u=l.query.client_id;b.default.checkUser(n,l)&&!Number.isNaN(Number(u))&&a((0,k.getOpenApiClientInfo)(u)).then(function(t){var a=t.app;e.setState(a)})}},{key:"onAuth",value:function(){var e=this.context,t=e.dispatch,a=e.location.query,n=a.client_id,l=a.redirect_uri,u=a.state,r=a.scope;t((0,k.authorization)({client_id:n,redirect_uri:l,state:u,scope:r})).then(function(e){var t=e.token,a=e.openId,n=e.state;if(window.URL&&window.URLSearchParams){var u=new URL(l),r=new URLSearchParams(u.search);r.set("token",t),r.set("openId",a),r.set("state",n),u.search=r,location.href=u.href}else location.href=l+"?token="+t+"&openId="+a+"&state="+n})}},{key:"render",value:function(){var e=this.context,t=e.i18n,a=e.location.query,n=a.client_id,l=a.redirect_uri,u=void 0===l?"":l,r=this.state,i=r.name,s=r.site,o=!n||!u||!u.startsWith(s);try{window.URL&&new URL(u)}catch(e){o=!0}return h.default.createElement("main",{className:v.default.main},h.default.createElement("div",{className:v.default.space}),o?h.default.createElement("div",{className:v.default.form},t[1550]):h.default.createElement("div",{className:v.default.form},h.default.createElement("div",{className:v.default.input},h.default.createElement("p",null,(0,_.i18nEmbed)(t[1551],h.default.createElement("a",{key:0,className:"clickable",href:s,target:"_blank"},i))),h.default.createElement("ul",{className:v.default.authlist},h.default.createElement("li",null,t[1552]),h.default.createElement("li",null,t[1553]))),h.default.createElement("button",{className:"alone",onClick:this.onAuth},t[1554])),h.default.createElement("div",{className:v.default.links},h.default.createElement(w.default,{i18n:t})))}}]),t}(h.default.Component);t.default=N,N.contextTypes={i18n:m.default.object,user:m.default.object,location:m.default.object,dispatch:m.default.func}},876:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(t.emailPattern="^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$",t.usernamePattern="(?:^[a-z]|[0-9])([a-z]|[0-9]|-){2,30}[a-z0-9]$",t.nicknamePattern=".{0,40}",t.passwordPattern=".{6,32}",t.phonePattern="\\d{0,18}",t.phoneVerifyPattern="\\d{4}",t.imageVerifyPattern=".{6}",t.galleryNamePattern="^\\S+.*");t.watermarkNamePattern=n,t.cateNamePattern=n,t.hotLinkUrlPattern="([a-zA-Z0-9|\\*|\\-]{1,62}\\.){1,4}[a-zA-Z0-9|\\-]{1,62}"},885:function(e,t){e.exports={main:"login__main",space:"login__space",form:"login__form",middle:"login__middle",terms:"login__terms",middlewrap:"login__middlewrap",tipswrap:"login__tipswrap",oauthregtitle:"login__oauthregtitle",oauthregdec:"login__oauthregdec",input:"login__input",inlinelink:"login__inlinelink",button:"login__button",loading:"login__loading",relatedlink:"login__relatedlink",links:"login__links",recoveredtitle:"login__recoveredtitle",recoveredtext:"login__recoveredtext",authlist:"login__authlist",aligninput:"login__aligninput"}},889:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(2),u=n(l),r=a(3),i=n(r),s=a(4),o=n(s),d=a(5),c=n(d),f=a(6),m=n(f),p=a(1),h=n(p),g=a(1254),v=n(g),_=a(141),E=a(146),b=a(26),y=n(b),w=function(e){function t(e){(0,u.default)(this,t);var a=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSetLanguage=a.onSetLanguage.bind(a),a}return(0,c.default)(t,e),(0,i.default)(t,[{key:"onSetLanguage",value:function(e){(0,this.context.dispatch)({type:e?E.SET_LANGUAGE:E.CLEAR_SET,payload:e})}},{key:"render",value:function(){var e=this,t=this.props.i18n,a=void 0===t?this.context.i18n:t,n=(0,_.getApplyLanguage)(),l=(0,_.getValidLangs)();return h.default.createElement("nav",{className:v.default.main+" "+(this.props.className||"")},h.default.createElement("a",{href:"//"+y.default.website_host+"/about",target:"_blank"},a[86]),h.default.createElement("a",{href:"//"+y.default.website_host+"/privacy",target:"_blank"},a[87]),h.default.createElement("a",{href:"//"+y.default.website_host+"/price",target:"_blank"},a[88]),h.default.createElement("a",{href:"//"+y.default.website_host+"/help",target:"_blank"},a[131]),h.default.createElement("a",{href:"//"+y.default.website_host+"/contact",target:"_blank"},a[91]),h.default.createElement("a",{href:"//www.upyun.com",rel:"nofollow",target:"_blank"},a[92]),h.default.createElement("a",{className:v.default.lang},h.default.createElement("span",{className:v.default.currentlang},a[n]),l.length>1&&h.default.createElement("i",{className:"icon_dropdown"}),l.length>1&&h.default.createElement("ul",null,l.map(function(t,l){return n!==t&&h.default.createElement("li",{key:l,onClick:e.onSetLanguage.bind(null,t)},a[t])}))))}}]),t}(h.default.Component);t.default=w,w.propTypes={i18n:m.default.object,className:m.default.string},w.contextTypes={location:m.default.object,i18n:m.default.object,dispatch:m.default.func}},895:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(7),u=n(l),r=a(2),i=n(r),s=a(3),o=n(s),d=a(4),c=n(d),f=a(5),m=n(f),p=a(6),h=n(p),g=a(1),v=n(g),_=a(26),E=n(_),b=a(8),y=a(68),w=n(y),k=a(1038),N=n(k),x=a(1039),S=n(x),C=new Map,P=function(e){if(!C.has(e)){var t=new Promise(function(t,a){var n=document.createElement("script");n.onload=t,n.onerror=function(){C.delete(e),document.body.removeChild(n),a()},n.src=e,document.body.appendChild(n)});C.set(e,t)}return C.get(e)},O=1,T=function(e){function t(e){(0,i.default)(this,t);var a=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.id=O++,a.nc=null,a.initState={sig:"",csessionid:"",nc_token:"",nc_scene:""},a.state=(0,u.default)({},a.initState,{remind:!1,invalid:!1}),a}return(0,m.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.i18n,n=t.scene,l=this.refs.wrap,r=[E.default.smartCaptcha.appKey,(new Date).getTime(),Math.random()].join(":"),i=function(t){e.setState({invalid:!1,sig:t.sig,csessionid:t.csessionid,nc_token:r,nc_scene:"nc_"+n})},s={renderTo:"#sc-"+this.id,appkey:E.default.smartCaptcha.appKey,token:r,language:"cn",callback:i};(0,b.isMobile)()?P("//g.alicdn.com/sd/nch5/index.js").then(function(){var t=(0,u.default)({},s,{scene:(0,S.default)(n+"_h5")});e.nc=window.NoCaptcha.init(t),window.NoCaptcha.setEnabled(!0),e.reset(),window.NoCaptcha.upLang("cn",{LOADING:a[2908],SLIDER_LABEL:a[2909],CHECK_Y:a[2910],ERROR_TITLE:a[2911],CHECK_N:a[2912],OVERLAY_INFORM:a[2913],TIPS_TITLE:a[2914]})}):P("//g.alicdn.com/sd/ncpc/nc.js").then(function(){var t=(0,u.default)({},s,{scene:(0,S.default)("nc_"+n),customWidth:Math.floor(l.getBoundingClientRect().width)});e.nc=new window.noCaptcha(t),e.nc.upLang("cn",{_startTEXT:a[2904],_yesTEXT:a[2905],_error300:a[2906],_errorNetwork:a[2907]})}),l.addEventListener("animationend",function(){return e.setState((0,u.default)({},e.state,{remind:!1}))})}},{key:"render",value:function(){var e=this.props.className,t=this.state,a=t.invalid,n=t.remind;return v.default.createElement("div",{ref:"wrap",id:"sc-"+this.id,className:"\n          nc-container\n          "+e+"\n          "+N.default.wrap+"\n          "+(a&&N.default.invalid)+"\n          "+(n&&w.default.shakeX)+"\n          "+w.default.startAnimate+"\n        "})}},{key:"reset",value:function(){this.nc&&this.nc.reset(),this.setState((0,u.default)({},this.initState,{remind:!1}))}},{key:"valid",value:function(){for(var e in this.initState)if(!this.state[e])return this.setState({invalid:!0,remind:window.experimentalOption.valid("validerrorshake")}),!1;return!0}},{key:"value",get:function(){var e=this,t={};return Object.keys(this.initState).forEach(function(a){return t[a]=e.state[a]}),t}}]),t}(v.default.Component);t.default=T,T.propTypes={i18n:h.default.object.isRequired,scene:h.default.string,className:h.default.string}}});
//# sourceMappingURL=auth.chunk.js.map